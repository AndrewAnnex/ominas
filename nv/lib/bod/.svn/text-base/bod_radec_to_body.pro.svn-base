;===========================================================================
; bod_radec_to_body
;
; v is array (nv,3,nt) of column vectors.  result is array (nv,3,nt)
;
;===========================================================================
function bod_radec_to_body, bxp, v
@nv_lib.include
 bdp = class_extract(bxp, 'BODY')
 bd = nv_dereference(bdp)

 nv = (size(v))[1]
 nt = n_elements(bd)

 result = dblarr(nv,3,nt, /nozero)

 r_cos_dec = v[*,2,*] * cos(v[*,1,*])

 result[*,0,*] = r_cos_dec * cos(v[*,0,*])
 result[*,1,*] = r_cos_dec * sin(v[*,0,*])
 result[*,2,*] = v[*,2,*] * sin(v[*,1,*])

 return, result
end
;===========================================================================



