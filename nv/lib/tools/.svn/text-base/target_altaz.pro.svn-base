;===================================================================================
; target_altaz
;
;  bx is the target, lat/lon are coords of observer on planet pd.
;
;===================================================================================
function target_altaz, bx, pd, lat, lon, alt
 
; rad = glb_get_radius(pd[0], lat, lon)
; surf_pt = transpose([lat, lon, rad+alt])
 surf_pt = transpose([lat, lon, alt])

 body_pt = glb_globe_to_body(pd, surf_pt)

 altaz = glb_local_to_altaz(pd, body_pt, $
           glb_body_to_local(pd, body_pt, $ 
             bod_inertial_to_body_pos(pd, bod_pos(bx))))

 return, altaz
end
;===================================================================================
