;==============================================================================
; disk_to_corot_lon
;
;==============================================================================
function disk_to_corot_lon, disk_lons, cd=cd, dkx=dkx, frame_bd=frame_bd, t0=t0, $
           dmldt=dmldt

 if(NOT keyword_set(t0)) then t0 = 0d
 nv = n_elements(disk_lons)

 if(NOT keyword_set(dmldt)) then dmldt = orb_compute_dmldt(dkx, frame_bd)
 t = bod_time(cd)

 lon0 = dmldt * (t - t0[0])

 corot_lons = reduce_angle(disk_lons - lon0##make_array(nv,val=1d))

 return, corot_lons
end
;==============================================================================
