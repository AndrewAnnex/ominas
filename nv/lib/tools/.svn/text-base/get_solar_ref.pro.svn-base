;===========================================================================
; get_solar_ref
;
; returns array (1,3,nt) of inertial unit vectors giving projection of sun
;  direction into disk plane.
;
;===========================================================================
function get_solar_ref, dkx, sund

 dsk_bd = class_extract(dkx, 'BODY')
 sun_bd = class_extract(sund, 'BODY')

 v = bod_pos(sun_bd) - bod_pos(dsk_bd)
 vv = bod_inertial_to_body(dsk_bd, v)

 vv[*,2,*] = 0

 result = bod_body_to_inertial(dsk_bd, v_unit(vv))

 return, result
end
;===========================================================================



