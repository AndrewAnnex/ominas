;=============================================================================
; image_to_surface
;
;=============================================================================
function image_to_surface, cd, bx, p, frame_bd=frame_bd, body_pts=body_pts, $
                                discriminant=discriminant, hit=hit, valid=valid

 if(NOT keyword_set(p)) then return, 0

 gbd = class_extract(bx, 'GLOBE')
 dkd = class_extract(bx, 'DISK')

 if(keyword_set(gbd)) then $
         return, image_to_globe(cd, bx, p, body_pts=body_pts, $
                                           discriminant=discriminant, valid=valid)

 if(keyword_set(dkd)) then $
         return, image_to_disk(cd, bx, p, frame_bd=frame_bd, $
                                           body_pts=body_pts, hit=hit, valid=valid)

 hit = make_array(n_elements(p[0,*]), val=1b)
 return, image_to_radec(cd, p, body_pts=body_pts)

end
;==========================================================================
