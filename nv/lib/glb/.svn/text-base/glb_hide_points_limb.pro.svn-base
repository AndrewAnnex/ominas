;===========================================================================
; glb_hide_points_limb.pro
;
; Inputs are in body coordinates.
;
; Returns subscripts of points hidden behind the limb.
;
;===========================================================================
function glb_hide_points_limb, gbxp, r, points
@nv_lib.include
 gbdp = class_extract(gbxp, 'GLOBE')

 nt = n_elements(gbdp)
 nv = (size(points))[1]

 x = points - r[gen3y(nv,3,nt)]
 n = glb_get_surface_normal_body(gbdp, points)

 sub = where(v_inner(n,x) GT 0)

 return, sub
end
;===========================================================================
