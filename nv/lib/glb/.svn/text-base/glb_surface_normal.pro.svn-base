;=============================================================================
; glb_surface_normal
;
; r in body frame
;=============================================================================
function glb_surface_normal, gbxp, r
@nv_lib.include
 gbdp = class_extract(gbxp, 'GLOBE')
 nv_notify, gbdp, type = 1
 gbd = nv_dereference(gbdp)


 nv = (size(r))[1]
 nt = n_elements(gbd)

 radii = (gbd.radii)[linegen3x(nv,3,nt)]

 return, v_unit(r/radii^2)
end
;=============================================================================
