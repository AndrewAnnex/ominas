;==============================================================================
; glb_sub_point
;
;  Returns the planetocentric sub-point in body coordinates.
;
;==============================================================================
function glb_sub_point, gbxp, v
@nv_lib.include
 gbdp = class_extract(gbxp, 'GLOBE')
 nv_notify, gbdp, type = 1
 gbd = nv_dereference(gbdp)

 nv = (size(v))[1]
 nt = n_elements(gbd)

; a = gbd.radii[0]
; b = gbd.radii[1]
; c = gbd.radii[2]

 surf_pts = glb_body_to_globe(gbdp, v)
; surf_pts[*,2,*] = glb_get_radius(gbdp, surf_pts[*,0,*], surf_pts[*,1,*])
 surf_pts[*,2,*] = 0d

 result = glb_globe_to_body(gbdp, surf_pts)

 return, result
end
;==============================================================================
