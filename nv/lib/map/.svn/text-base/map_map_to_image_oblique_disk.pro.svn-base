;===========================================================================
; map_map_to_image_oblique_disk
;
;===========================================================================
function map_map_to_image_oblique_disk, mdp, map_pts, valid=valid
 md = nv_dereference(mdp)

 nt = n_elements(md)
 sv = size(map_pts)
 nv = 1
 if(sv[0] GT 1) then nv = sv[2]

 result = dblarr(2,nv,nt, /nozero)

 R = 0.5*min(md.size)*md.scale

 rad = map_pts[0,*,*] * md.units[0]
 lon = (map_pts[1,*,*] - md.center[1]) * md.units[1]

 rr = rad / 2d/!dpi * R

 result[0,*,*] = rr*cos(lon)
 result[1,*,*] = rr*sin(lon)

 result[0,*,*] = result[0,*,*] + md.origin[0]
 result[1,*,*] = result[1,*,*]*sin(md.center[0]) + md.origin[1]

 valid = lindgen(nv*nt)
 return, result
end
;===========================================================================



