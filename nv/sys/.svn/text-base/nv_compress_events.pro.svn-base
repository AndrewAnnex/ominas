;=============================================================================
; nv_compress_events
;
;=============================================================================
function nv_compress_events, buf
@nv.include

 if(NOT keyword__set(buf)) then return, 0

 n = n_elements(buf)
 mark = bytarr(n)

 ;------------------------------------------
 ; mark events to remove
 ;------------------------------------------
 for i=0, n-1 do $
  begin
   event = buf[i]
   w = where((buf.type EQ event.type) AND $
             (buf.handler EQ event.handler) AND $
             (buf.data EQ event.data) AND $
             (buf.data_p EQ event.data_p) AND $
             (buf.idp EQ event.idp))
   if(n_elements(w) GT 1) then mark[w[1:*]] = 1 
  end

 ;-------------------------------------------------------------------------
 ; remove marked events
 ;-------------------------------------------------------------------------
 w = where(mark EQ 1)
 if(w[0] NE -1) then events = rm_list_item(buf, w) $
 else events = buf


 return, events
end
;=============================================================================
