READSPREADSHEET

 PURPOSE:
      This function reads data in PDS Spreadsheet object.

      This function is meant to be integrated into the READPDS package
      from the PDS Small Bodies Node to add spreadsheet support.

 CATEGORY:
      Scientific Data Extraction Routines

 CALLING SEQUENCE:
      Result = READSPREADSHEET(filename, label, objindex [,SILENT] [,PRINT_TIME])

      Note: this routine is intended to be called from the READPDS.PRO routine
      (see examples below)

 INPUTS:
      Filename: Scalar string containing the name of the PDS file to read.
      Label: String array containing the spreadsheet label information.
      Objindex: Integer specifying the starting index of the current object
         in the label array to be read.

 OUTPUTS:
      Result: Spreadsheet structure containing records for each field in the object,
      along with a string array NAMES with the names of all the fields.

 OPTIONAL INPUT:
      SILENT: Suppresses any messages from the procedure.
      PRINT_TIME: Prints processing times for each of the Fields

 EXTERNAL FUNCTIONS USED:
      SBNIDL ReadPDS Package: OBJPDS, GET_INDEX, CLEAN, REMOVE, STR2NUM, PDSPAR, POINTPDS

 PROCEDURE:
      (1) Preprocess object definition parameters
      (2) Create data structure to be read
      (3) Read data structure from file using subroutine
      (4) Re-organize data structures into arrays
      (5) Return Data

 SIDE EFFECTS:
      Fields with missing values (e.g. 2,1,,,4,5,,7,,,) are converted to ZERO
      This should be corrected in a later version. Possible using NaN (!values.f_nan)

 TEST STATUS
      This routine has been tested on SUN/SPARC/SOLARIS2.9 and WINDOWS XP with IDL6.1

 EXAMPLES:
      This routine is intended to be called from the READPDS.PRO routine
      To read a PDS file TEST.LBL into an IDL spreadsheet structure, spr:
        IDL> spr = READPDS ("TEST.LBL",/SILENT)
        IDL> help, /STRUCTURE, spr
               OBJECTS      INT       1
               SPREADSHEET  STRUCT    -> <Anonymous> Array[1]
        IDL> help, /STRUCTURE, spr.(1)
               NAMES           STRING    Array[8]
               FIELD1           TYPE     Array[...]
               FIELD2           TYPE     Array[...]
                ...
               FIELDN           TYPE     Array[...]

 MODIFICATION HISTORY:
   Written by: A.Cardesin (ESA/ESTEC), 2006Feb (based on TASCPDS by P.Khetarpal)
