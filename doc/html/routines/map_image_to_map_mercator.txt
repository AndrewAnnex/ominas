MAP_IMAGE_TO_MAP_MERCATOR


 PURPOSE:
	Transforms the given image points to map coordinate points
	using a mercator projection.


 CATEGORY:
	NV/LIB/MAP


 CALLING SEQUENCE:
	map_pts = map_image_to_map_mercator(md, image_pts)


 ARGUMENTS:
  INPUT: 
	md	 	Array (nt) of MAP descriptors.

	image_pts:	Array (2,nv,nt) of map image points.

  OUTPUT: NONE


 KEYWORDS:
  INPUT: NONE

  OUTPUT: 
	valid:	Indices of all input points that correspond to valid
		output map points.  If not set then all points are
		valid.


 RETURN:
	Array (2,nv,nt) of map coordinate points in a mercator projection.
	This projection results from projecting a sphere onto a cylinder
	that is tangent at the equator.  The scale is true along the equator
	only.  Areas are distorted, especially near the poles.  

	With:
 
		a = [size[1]/pi, size[0]/2pi] * scale * units,

	and:

		e = sqrt(1 - (A/(B+C)/2)^2),

	where A, B, and C are the triaxial ellipsoid radii, the 
	transformation is:

		pi/2 - 2*atan(exp(-y/a[0]) * 
		         ((1 - e*sin(lat))/(1 + e*sin(lat)))^(e/2)) 

		lon = x/a[1] + center[1]

	where the latitude equation is solved iteratively.

	See [1], p. 45 for the mathematical derivation.

	[1] Snyder (1987)
	    Map projections -- A working manual
	    USGS professional paper 1395


 STATUS:
	Complete


 MODIFICATION HISTORY:
 	Written by:	Spitale, 1/1998
	
