RAYTACE


 PURPOSE:
	Traces rays from a camera to a set of objects.


 CATEGORY:
	NV/PG


 CALLING SEQUENCE:
	raytrace, image_pts, cd=cd, bx=bx		; For primary rays
		hit_matrix=hit_matrix, $
		hit_indices=hit_indices, $
		range_matrix=range_matrix, hit_list=hit_list

	raytrace, bx=bx, sbx=sbx, $			; For secondary rays
		hit_matrix=hit_matrix, $
		hit_indices=hit_indices, $
		range_matrix=range_matrix, hit_list=hit_list


 ARGUMENTS:
  INPUT: 
	image_pts:  Array (2,np) of image points relative to cd.  These
	            points will be turned into rays to be traced from the 
	            position of the camera.

  OUTPUT: NONE


 KEYWORDS:
  INPUT:
	cd:	       Camera descriptor.

	bx:	       Array of object descriptors; must be a subclass of BODY.

	sbx:           Body descriptor for secondary ray tracing.  If set, 
	               image_pts and cd are not used; instead, secondary rays 
	               are traced from the given hit_matrix points to sbx.

	hit_matrix:    Body-frame points from prior call, to be used as
	               source points for secondary rays.  

	hit_indices:   Body index for each secondary ray.

	limit_source : If set, secondary vectors originating on a given
	               body are not considered for targets that are the
	               same body.  Default is off.

	standoff:      If given, secondary vectors are advanced by this distance
	               before tracing in order to avoid hitting target bodies
	               through round-off error.  Default is 1 unit.

	penumbra:      If set, lighting rays are traced to random points on 
	               each secondary body rather then the center.



  OUTPUT: 
	hit_list:     Array (nhit) giving indices of all bx that have ray 
	              intersections.  

	hit_indices:  Array (nray) of body indices corresponding to the first 
	              intersection for each ray.  

	hit_matrix:   Array (nray,3,nhit) of body-frame points for nearest 
	              ray intersections. 

	range_matrix: Array (nhit,nray) giving distance to the near-side
	              ray intersection for each body in the hit_matrix.  

	near_matrix:  Array (nray,3,nhit) of body-frame points for all
	              near-side intersections with bodies in the hit_list.

	far_matrix:   Array (nray,3,nhit) of body-frame points for all
	              far-side intersections with bodies in the hit_list.


 RETURN: NONE


 PROCEDURE:
	


 EXAMPLE:


 STATUS:
	Complete


 MODIFICATION HISTORY:
 	Written by:	Spitale
	
