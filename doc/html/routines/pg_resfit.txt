PG_RESFIT


 PURPOSE:
	Computes polynomial coefficients for a camera distortion model by
	comparing detected reseaus with the known focal plane locations.


 CATEGORY:
	NV/PG


 CALLING SEQUENCE:
	pg_resfit, scan_ps, foc_ps, n, cd=cd


 ARGUMENTS:
  INPUT:
	scan_ps:	pg_points_struct containing image coordinates of 
			the scanned reseau candidates as output by pg_resloc.

	foc_ps:		pg_points_struct containing the known focal
			coordinates of the reseau marks.

	n:		Order of polynomial to fit.  Default is 4.

  OUTPUT:
	NONE


 KEYWORDS:
  INPUT:
       cd:		Camera descriptor to be modified.

       gd:		Generic descriptor containing the camera descriptor 
			to be modified.

       range:		Range to use in associating candidate reseaus
			with known reseaus. default is 10 pixels.

	assoc:		If set, the program returns after generating 
			the scan_sub array, but before fitting the polynomial
			coefficients.

	nom_ps:		If given, this pg_points_struct contains image
			coordinates of nominal reseau locations corresponding 
			to each point in foc_ps.  The positions of each mark 
			for which there is no scan_ps match is computed 
			as the nominal position plus an offset determined
			by looking at the differences between neighboring
			scanned marks and their corresponding nominal positions.

	use_nom:	If set, scan_ps will be ignored and nom_ps will be used
			instead.

  OUTPUT:
	res_ps:		pg_points_struct containing the new image
			coordinates of the known reseau marks.

	fcp:		pg_points_struct returning the focal points from
			foc_ps that were able to be associated with a scanned
			reseau.

	scp:		pg_points_struct returning the scanned points from
			scan_ps that were able to be associated with a
			known location.

 RETURN:
	NONE


 PROCEDURE:
	First, candidate reseaus are associated with nominal reseaus by 
	choosing the candidate with the highest correlation coefficient 
	within a given number of pixels surrounding each known reseau.

	Next, coefficients for a polynomial of order n are derived using a
	least-squares fit.


 STATUS:
	Complete


 SEE ALSO:
	pg_resloc, pg_linearize_image, pg_blemish


 MODIFICATION HISTORY:
 	Written by:	Spitale, 5/2002
	
