CAS_DESKY


 PURPOSE:
	To remove horizontal banding in Cassini images by removing
	the background which includes the bias and dark current


 CATEGORY:
	UTIL/CASSINI


 CALLING SEQUENCE:
	result = cas_desky(image, sample)


 ARGUMENTS:
  INPUT:
	image:	Image data

	sample: Array of sample segments [start_x1, end_x1, start_x2, ...]

  OUTPUT:
	NONE

 KEYWORDS:
  INPUT:
	tol:	DN tolerance around median to include in average

	maxsig:	Sigma tolerance above mean to include in average

	width:	If set, median is done using a box this size rather
		than across lines

      smooth:  Smooth the calculated result vertically using this
	        number of pixels (should be odd number)

	 skip:  If specified, will skip the before and after pixel
	        of pixels that are thrown out.  /skip does not work
	        when using width.

 RETURN:
	Real image with horizontal banding, bias and DC mostly subtracted.


 PROCEDURE:
	This routine calculates an average background to subtract by
	median filtering (or sigma filtering) and averaging the image between
	the given sample ranges.  The averaging is done in the sample direction 
	because both the horizontal banding and the dark current is nearly
	constant along this direction.  The area selection should be almost all
	sky for a reasonable result.  This routine may not work well in images
	with strong gradiants.


 STATUS:
	Tweeks still being applied.


 MODIFICATION HISTORY:
 	Written by:	V. Haemmerle, 3/2000
	Modified by:    V. Haemmerle, 1/2001
	
