;=============================================================================
; colgen
;
; Generates an array of subscripts to select only the desired column n-vectors
; from an array with dimensions nv x n x nt.  w is a 1-d array of nw subscripts
; selecting from the (nv x nt) column vectors.  The resulting array has
; dimensions nw x n.
;
;=============================================================================
function colgen, nv, n, nt, w

 wv = w mod nv
 wt = fix(w / nv)

 nnv = n*nv
 nw = n_elements(w)

 ww = lonarr(nw,n)

 ww[*,0] = wt * nnv + wv
 for i=1, n-1 do ww[*,i] = ww[*,i-1] + nv
  

 return, ww
end
;=============================================================================
